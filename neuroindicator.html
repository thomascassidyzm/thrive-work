<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClearMinds Wellness Check-In - How Are You Doing?</title>
    <meta name="description" content="Quick 4-minute check-in (9 questions) to connect you with the right support and welcome you to our 91,000-member community.">

    <!-- jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        :root {
            --clearminds-teal: #007a87;
            --clearminds-dark: #0d3b3e;
            --clearminds-green: #dff4da;
            --clearminds-cream: #fffbf5;
            --text-dark: #333;
            --text-light: #666;
            --border-light: #e5e7eb;
            --warning-yellow: #fff3cd;
            --warning-orange: #ff9800;
            --crisis-red: #dc3545;
            --success-green: #28a745;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, var(--clearminds-cream) 0%, #fff 100%);
            color: var(--text-dark);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0.75rem;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 1rem;
            background: linear-gradient(135deg, var(--clearminds-teal) 0%, var(--clearminds-dark) 100%);
            color: white;
            border-radius: 0 0 12px 12px;
            margin-bottom: 1rem;
        }

        .header h1 {
            font-size: 1.5rem;
            margin-bottom: 0.25rem;
            font-weight: 700;
        }

        .header p {
            font-size: 0.9rem;
            opacity: 0.95;
            max-width: 700px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid var(--border-light);
        }

        .card h2 {
            color: var(--clearminds-dark);
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .card h3 {
            color: var(--clearminds-teal);
            margin: 1rem 0 0.75rem;
            font-size: 1.1rem;
        }

        /* Warning box */
        .warning-box {
            background: var(--warning-yellow);
            border-left: 4px solid var(--warning-orange);
            padding: 0.75rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .warning-box h3 {
            color: #856404;
            margin: 0 0 0.5rem 0;
            font-size: 0.95rem;
        }

        .warning-box p {
            color: #856404;
            margin: 0.5rem 0;
            font-size: 0.85rem;
        }

        /* Crisis banner */
        .crisis-banner {
            background: var(--crisis-red);
            color: white;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .crisis-banner a {
            color: white;
            text-decoration: underline;
        }

        /* Buttons */
        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            background: var(--clearminds-teal);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s ease;
            text-align: center;
        }

        .btn:hover {
            background: var(--clearminds-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 122, 135, 0.3);
        }

        .btn-secondary {
            background: var(--border-light);
            color: var(--text-dark);
        }

        .btn-secondary:hover {
            background: #d1d5db;
        }

        .btn-block {
            width: 100%;
            margin-top: 1rem;
        }

        /* Progress bar */
        .progress-container {
            margin: 1rem 0 0.5rem;
        }

        .progress-bar {
            background: var(--border-light);
            border-radius: 8px;
            height: 8px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            background: linear-gradient(90deg, var(--clearminds-teal), var(--clearminds-dark));
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 8px;
        }

        .progress-text {
            text-align: center;
            color: var(--text-light);
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        /* Question card */
        .question-card {
            background: white;
            border-radius: 12px;
            padding: 1.25rem;
            margin-bottom: 0.75rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 2px solid var(--clearminds-teal);
            max-height: 60vh;
            overflow-y: auto;
        }

        .question-number {
            color: var(--clearminds-teal);
            font-weight: 600;
            font-size: 0.75rem;
            margin-bottom: 0.5rem;
        }

        .question-text {
            font-size: 1.05rem;
            color: var(--clearminds-dark);
            margin-bottom: 1rem;
            font-weight: 500;
            line-height: 1.4;
        }

        /* Radio buttons styled as cards */
        .option-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .option-card {
            position: relative;
        }

        .option-card input[type="radio"] {
            position: absolute;
            opacity: 0;
        }

        .option-card label {
            display: block;
            padding: 0.85rem;
            background: var(--clearminds-cream);
            border: 2px solid var(--border-light);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            line-height: 1.3;
        }

        .option-card input[type="radio"]:checked + label {
            background: var(--clearminds-green);
            border-color: var(--clearminds-teal);
            font-weight: 600;
        }

        .option-card label:hover {
            border-color: var(--clearminds-teal);
            background: var(--clearminds-green);
        }

        /* Results page */
        .result-header {
            background: var(--clearminds-green);
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            border-left: 6px solid var(--clearminds-teal);
        }

        .result-header h2 {
            color: var(--clearminds-dark);
            margin-bottom: 0.5rem;
            font-size: 1.3rem;
        }

        .pathway-card {
            background: white;
            border: 2px solid var(--clearminds-teal);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .pathway-card h3 {
            color: var(--clearminds-teal);
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }

        .pathway-card ul {
            margin-left: 1rem;
            margin-top: 0.5rem;
        }

        .pathway-card li {
            margin-bottom: 0.4rem;
            font-size: 0.9rem;
        }

        .ocean-promo {
            background: linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%);
            border: 2px solid #3b82f6;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .ocean-promo h3 {
            color: #1e40af;
            margin-top: 0;
        }

        .ocean-badge {
            display: inline-block;
            background: #3b82f6;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        /* Hidden class */
        .hidden {
            display: none !important;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.3rem;
            }

            .header p {
                font-size: 0.85rem;
            }

            .card {
                padding: 0.75rem;
            }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <div class="header">
        <h1>üß† How Are You Doing Right Now?</h1>
        <p>A quick 2-minute check-in to connect you with the right support and welcome you to our community.</p>
    </div>

    <div class="container">
        <!-- Pre-Assessment Page -->
        <div id="pre-assessment" class="card">
            <h2>Welcome to Clear Minds</h2>

            <p style="font-size: 0.95rem; margin-bottom: 1rem; line-height: 1.5;">
                Let's start with a quick check-in. This takes about 4 minutes (9 questions) and helps us connect you with the right support and welcome you to our 91,000-member community.
            </p>

            <div class="warning-box">
                <h3>‚ö†Ô∏è Important: This is NOT a clinical assessment</h3>
                <p>This is a starting point to understand what you're experiencing. It's not a medical diagnosis‚Äîonly qualified healthcare professionals can provide diagnoses.</p>
                <p><strong>If you're in crisis:</strong> Call 999, visit A&amp;E, or contact Samaritans (116 123)</p>
            </div>

            <h3>What to expect:</h3>
            <ul style="margin-left: 1.5rem; margin-bottom: 1rem; font-size: 0.9rem;">
                <li style="margin-bottom: 0.3rem;">9 questions (4 minutes)</li>
                <li style="margin-bottom: 0.3rem;">Questions about wellbeing, work impact, and support needs</li>
                <li style="margin-bottom: 0.3rem;">Immediate welcome to our support community</li>
                <li style="margin-bottom: 0.3rem;">Personalized pathway recommendations</li>
                <li style="margin-bottom: 0.3rem;">Optional GP summary if you want to involve your doctor</li>
            </ul>

            <h3>Your Privacy</h3>
            <p style="margin-bottom: 1rem; font-size: 0.9rem;">
                Your responses are processed in your browser and never shared with your employer. See our <a href="/corporate/policies/data-governance/privacy-policy.html" style="color: var(--clearminds-teal);">Privacy Policy</a> for details.
            </p>

            <button class="btn btn-block" onclick="app.startAssessment()">Start Check-In</button>
        </div>

        <!-- Assessment Page -->
        <div id="assessment" class="hidden">
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                </div>
                <div class="progress-text" id="progress-text">Question 1 of 9</div>
            </div>

            <div class="question-card" id="question-card">
                <!-- Questions will be inserted here -->
            </div>

            <p style="text-align: center; color: var(--text-light); font-size: 0.85rem; margin: 0.75rem 0;">
                Select an answer to automatically continue
            </p>

            <div style="display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center;">
                <button class="btn btn-secondary" id="btn-back" onclick="app.previousQuestion()" style="display: none;">‚Üê Back</button>
                <button class="btn" id="btn-next" onclick="app.nextQuestion()" style="display: none;">Next ‚Üí</button>
            </div>
        </div>

        <!-- Results Page -->
        <div id="results" class="hidden">
            <div class="result-header">
                <h2 id="result-title">Welcome to Clear Minds</h2>
                <p id="result-summary"></p>
            </div>

            <div id="result-pathways">
                <!-- Outcome pathways will be inserted here -->
            </div>

            <div style="display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center; margin-top: 1rem;">
                <button class="btn btn-secondary" onclick="app.restart()">Start New Check-In</button>
            </div>
        </div>
    </div>

    <script>
        // ClearMinds Wellness Check-In Application
        const app = {
            // State
            currentQuestion: 0,
            responses: [],
            userProfile: {
                wellness: 0,
                impact: 0,
                physicalSymptoms: 0,
                pathway: '',
                chronicity: '',
                socialConnection: 0,
                readiness: '',
                workImpact: 0,
                crisis: false,
                oceanCandidate: false,
                needsClinical: false,
                monitor: false
            },

            // Question bank (9 questions)
            questions: [
                {
                    id: 1,
                    text: "How are you feeling overall right now?",
                    type: "options",
                    options: [
                        {
                            value: 1,
                            text: "I'm doing well‚Äîjust checking in or curious",
                            signals: { wellness: 5, oceanCandidate: true }
                        },
                        {
                            value: 2,
                            text: "Managing okay, but could use some support",
                            signals: { wellness: 3, needsSupport: true }
                        },
                        {
                            value: 3,
                            text: "Struggling‚Äîthings feel hard right now",
                            signals: { wellness: 2, needsIntervention: true }
                        },
                        {
                            value: 4,
                            text: "In crisis‚ÄîI need immediate help",
                            signals: { crisis: true }
                        }
                    ]
                },
                {
                    id: 2,
                    text: "How much is this affecting your daily life?",
                    type: "options",
                    options: [
                        { value: 1, text: "Not affecting my life at all", impact: 0 },
                        { value: 2, text: "Minor impact, but I'm managing", impact: 1 },
                        { value: 3, text: "Moderate impact on work or relationships", impact: 2, needsClinical: true },
                        { value: 4, text: "Significant impact, struggling to function", impact: 3, needsClinical: true },
                        { value: 5, text: "Severe impact, can barely cope", impact: 4, needsClinical: true }
                    ]
                },
                {
                    id: 3,
                    text: "Are you experiencing any physical symptoms?",
                    type: "options",
                    options: [
                        { value: 1, text: "No physical symptoms", physicalSymptoms: 0 },
                        { value: 2, text: "Occasional (tension, headaches, fatigue)", physicalSymptoms: 1 },
                        { value: 3, text: "Frequent (multiple times per week)", physicalSymptoms: 2, needsClinical: true },
                        { value: 4, text: "Constant symptoms affecting daily life", physicalSymptoms: 3, needsClinical: true }
                    ]
                },
                {
                    id: 4,
                    text: "What's your main reason for checking in today?",
                    type: "options",
                    options: [
                        { value: 1, text: "Just exploring / general curiosity", pathway: "wellness", oceanCandidate: true },
                        { value: 2, text: "Work stress or burnout", pathway: "stress" },
                        { value: 3, text: "Sleep problems or low energy", pathway: "sleep" },
                        { value: 4, text: "Feeling anxious or worried a lot", pathway: "anxiety" },
                        { value: 5, text: "Low mood or feeling hopeless", pathway: "mood" },
                        { value: 6, text: "Trouble concentrating or staying focused", pathway: "focus" },
                        { value: 7, text: "Specific habit I want to change (smoking, drinking, weight)", pathway: "habits" },
                        { value: 8, text: "I want to understand myself better", pathway: "wellness", oceanCandidate: true },
                        { value: 9, text: "Looking for community support", pathway: "community" }
                    ]
                },
                {
                    id: 5,
                    text: "How long has this been going on?",
                    type: "options",
                    options: [
                        { value: 1, text: "Just started (last few days)", chronicity: "acute" },
                        { value: 2, text: "A few weeks", chronicity: "subacute" },
                        { value: 3, text: "A few months", chronicity: "chronic" },
                        { value: 4, text: "More than 6 months", chronicity: "chronic", clinicalConsideration: true },
                        { value: 5, text: "This is ongoing / chronic", chronicity: "chronic", clinicalConsideration: true },
                        { value: 6, text: "Not applicable‚ÄîI'm here for prevention/optimization", chronicity: "none", oceanCandidate: true }
                    ]
                },
                {
                    id: 6,
                    text: "How are your relationships and social connections?",
                    type: "options",
                    options: [
                        { value: 1, text: "Strong support network, feeling connected", socialConnection: 3 },
                        { value: 2, text: "Some good relationships, could be better", socialConnection: 2 },
                        { value: 3, text: "Feeling somewhat isolated or disconnected", socialConnection: 1, needsCommunity: true },
                        { value: 4, text: "Very isolated, struggling to maintain relationships", socialConnection: 0, needsCommunity: true, needsClinical: true }
                    ]
                },
                {
                    id: 7,
                    text: "Have you tried anything to help so far?",
                    type: "options",
                    options: [
                        { value: 1, text: "Nothing yet‚Äîthis is my first step", readiness: "beginner" },
                        { value: 2, text: "Lifestyle changes (exercise, sleep, etc.) and they're helping a bit", readiness: "engaged" },
                        { value: 3, text: "I've tried things but not seeing much improvement", readiness: "frustrated", escalate: true },
                        { value: 4, text: "I'm currently getting professional help (therapy, medication, etc.)", readiness: "clinical" },
                        { value: 5, text: "I want to optimize even though I'm doing okay", readiness: "optimization", oceanCandidate: true }
                    ]
                },
                {
                    id: 8,
                    text: "How is this affecting your work or productivity?",
                    type: "options",
                    options: [
                        { value: 1, text: "Not affecting my work", workImpact: 0 },
                        { value: 2, text: "Occasionally distracted, but getting things done", workImpact: 1 },
                        { value: 3, text: "Noticeably impacting my performance", workImpact: 2 },
                        { value: 4, text: "Struggling to meet responsibilities", workImpact: 3, needsClinical: true },
                        { value: 5, text: "Unable to work effectively", workImpact: 4, needsClinical: true }
                    ]
                },
                {
                    id: 9,
                    text: "One more important question: Are you having thoughts of harming yourself or ending your life?",
                    type: "options",
                    options: [
                        { value: 1, text: "No, not at all", crisis: false },
                        { value: 2, text: "I've had passing thoughts, but I'm safe", crisis: false, monitor: true },
                        { value: 3, text: "Yes, I'm having these thoughts", crisis: true }
                    ],
                    critical: true
                }
            ],

            // Start assessment
            startAssessment() {
                document.getElementById('pre-assessment').classList.add('hidden');
                document.getElementById('assessment').classList.remove('hidden');
                this.currentQuestion = 0;
                this.responses = [];
                this.renderQuestion();
            },

            // Render current question
            renderQuestion() {
                const question = this.questions[this.currentQuestion];
                const card = document.getElementById('question-card');

                let html = `
                    <div class="question-number">Question ${this.currentQuestion + 1} of ${this.questions.length}</div>
                    <div class="question-text">${question.text}</div>
                    <div class="option-group">
                `;

                question.options.forEach((option, index) => {
                    html += `
                        <div class="option-card">
                            <input type="radio" name="q${question.id}" id="q${question.id}_${index}" value="${index}">
                            <label for="q${question.id}_${index}">${option.text}</label>
                        </div>
                    `;
                });

                html += '</div>';
                card.innerHTML = html;

                // Update progress
                const progress = ((this.currentQuestion + 1) / this.questions.length) * 100;
                document.getElementById('progress-fill').style.width = progress + '%';
                document.getElementById('progress-text').textContent = `Question ${this.currentQuestion + 1} of ${this.questions.length}`;

                // Show/hide back button
                document.getElementById('btn-back').style.display = this.currentQuestion > 0 ? 'inline-block' : 'none';

                // Show next button if question already answered
                const isAnswered = !!this.responses[this.currentQuestion];
                document.getElementById('btn-next').style.display = isAnswered ? 'inline-block' : 'none';

                // Pre-select if we've already answered
                if (this.responses[this.currentQuestion]) {
                    const selectedIndex = this.responses[this.currentQuestion].selectedIndex;
                    const radio = card.querySelector(`input[value="${selectedIndex}"]`);
                    if (radio) radio.checked = true;
                }

                // Add auto-progression on selection
                const radios = card.querySelectorAll('input[type="radio"]');
                radios.forEach(radio => {
                    radio.addEventListener('change', () => {
                        setTimeout(() => {
                            this.nextQuestion();
                        }, 600);
                    });
                });
            },

            // Next question
            nextQuestion() {
                const question = this.questions[this.currentQuestion];
                const selected = document.querySelector(`input[name="q${question.id}"]:checked`);

                if (!selected) {
                    return;
                }

                const selectedIndex = parseInt(selected.value);
                const selectedOption = question.options[selectedIndex];

                // Save response
                this.responses[this.currentQuestion] = {
                    questionId: question.id,
                    selectedIndex: selectedIndex,
                    option: selectedOption,
                    question: question
                };

                // Update user profile
                if (selectedOption.signals) {
                    if (selectedOption.signals.wellness) this.userProfile.wellness = selectedOption.signals.wellness;
                    if (selectedOption.signals.crisis) this.userProfile.crisis = true;
                    if (selectedOption.signals.oceanCandidate) this.userProfile.oceanCandidate = true;
                }
                if (selectedOption.impact !== undefined) this.userProfile.impact = selectedOption.impact;
                if (selectedOption.physicalSymptoms !== undefined) this.userProfile.physicalSymptoms = selectedOption.physicalSymptoms;
                if (selectedOption.pathway) this.userProfile.pathway = selectedOption.pathway;
                if (selectedOption.chronicity) this.userProfile.chronicity = selectedOption.chronicity;
                if (selectedOption.socialConnection !== undefined) this.userProfile.socialConnection = selectedOption.socialConnection;
                if (selectedOption.readiness) this.userProfile.readiness = selectedOption.readiness;
                if (selectedOption.workImpact !== undefined) this.userProfile.workImpact = selectedOption.workImpact;
                if (selectedOption.clinicalConsideration) this.userProfile.needsClinical = true;
                if (selectedOption.needsClinical) this.userProfile.needsClinical = true;
                if (selectedOption.escalate) this.userProfile.needsClinical = true;
                if (selectedOption.crisis) this.userProfile.crisis = true;
                if (selectedOption.monitor) this.userProfile.monitor = true;
                if (selectedOption.oceanCandidate) this.userProfile.oceanCandidate = true;
                if (selectedOption.needsCommunity) this.userProfile.needsCommunity = true;

                // Check for crisis on critical question
                if (question.critical && selectedOption.crisis) {
                    this.showCrisisIntervention();
                    return;
                }

                // Move to next question or show results
                if (this.currentQuestion < this.questions.length - 1) {
                    this.currentQuestion++;
                    this.renderQuestion();
                } else {
                    this.showResults();
                }
            },

            // Previous question
            previousQuestion() {
                if (this.currentQuestion > 0) {
                    this.currentQuestion--;
                    this.renderQuestion();
                }
            },

            // Show crisis intervention
            showCrisisIntervention() {
                document.getElementById('assessment').classList.add('hidden');
                document.getElementById('results').classList.remove('hidden');

                document.getElementById('result-title').textContent = 'üö® Immediate Support Needed';
                document.getElementById('result-summary').textContent = 'Based on your response, we strongly recommend seeking immediate support.';

                const pathways = document.getElementById('result-pathways');
                pathways.innerHTML = `
                    <div class="crisis-banner">
                        <h3 style="color: white; margin-bottom: 1rem;">‚ö†Ô∏è If you're in immediate danger or having thoughts of self-harm:</h3>
                        <ul style="margin-left: 2rem;">
                            <li><strong>Call 999</strong> or go to your nearest A&amp;E</li>
                            <li><strong>Call Samaritans: 116 123</strong> (free, 24/7)</li>
                            <li><strong>Text SHOUT to 85258</strong> (free crisis text line)</li>
                            <li><strong>Call NHS 111</strong> for urgent mental health support</li>
                        </ul>
                    </div>

                    <div class="pathway-card">
                        <h3>You Are Not Alone</h3>
                        <p>What you're experiencing is serious, but help is available. Please reach out to one of the services above right now.</p>

                        <h4 style="margin-top: 1.5rem;">Our Community is Here Too</h4>
                        <p>When you're ready, our 91,000-member community with 24/7 professional moderation can provide ongoing support. But right now, please contact a crisis service.</p>
                    </div>
                `;
            },

            // Show results
            showResults() {
                document.getElementById('assessment').classList.add('hidden');
                document.getElementById('results').classList.remove('hidden');

                const profile = this.userProfile;
                const pathways = document.getElementById('result-pathways');

                // Build results based on profile
                let resultsHTML = '';

                // Community welcome (ALWAYS FIRST) - Emphasize if isolated
                const communityEmphasis = profile.needsCommunity ?
                    '<p style="background: #fff9e6; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;"><strong>‚≠ê Based on your responses, connecting with our community is especially important for you right now.</strong> You mentioned feeling isolated‚Äîour 91,000 members are here to change that.</p>' : '';

                resultsHTML += `
                    <div class="pathway-card" style="border: 3px solid var(--clearminds-teal); background: var(--clearminds-green);">
                        <h3>ü§ù First: You're Part of Something Bigger</h3>
                        ${communityEmphasis}
                        <p><strong>Welcome to our 91,000-member support community</strong></p>
                        <p>You're not alone in what you're experiencing. Our community is:</p>
                        <ul>
                            <li>Active 24/7 with peer support from people who understand</li>
                            <li>Professionally moderated (zero serious incidents across 91k members)</li>
                            <li>Private and safe (your employer can't see your activity)</li>
                            <li>A place where most healing happens</li>
                        </ul>
                        <button class="btn btn-block" style="margin-top: 1rem;">Enter Community Now</button>
                    </div>
                `;

                // Personalized pathway based on Q2
                resultsHTML += `<div class="pathway-card"><h3>üéØ Your Personalized Pathway</h3>`;
                resultsHTML += `<p>Based on your check-in, here's support that matches what you're experiencing:</p>`;

                switch(profile.pathway) {
                    case 'stress':
                        resultsHTML += `
                            <h4 style="margin-top: 1rem;">For Work Stress & Burnout:</h4>
                            <ul>
                                <li><strong>Stress Management Hypnotherapy</strong> - 300+ sessions</li>
                                <li><strong>Burnout Prevention Program</strong></li>
                                <li><strong>AI Coach: Edward</strong> - Workplace stress specialist (unlimited conversations)</li>
                            </ul>
                        `;
                        break;
                    case 'sleep':
                        resultsHTML += `
                            <h4 style="margin-top: 1rem;">For Sleep Problems:</h4>
                            <ul>
                                <li><strong>Sleep Support Hypnotherapy</strong> - 8-week program</li>
                                <li><strong>Insomnia CBT techniques</strong></li>
                                <li><strong>AI Coach: Kainne</strong> - Work-life balance & sleep hygiene</li>
                            </ul>
                        `;
                        break;
                    case 'anxiety':
                        resultsHTML += `
                            <h4 style="margin-top: 1rem;">For Anxiety:</h4>
                            <ul>
                                <li><strong>Anxiety Relief Hypnotherapy</strong> - Evidence-based sessions</li>
                                <li><strong>AI Coach: Lucy</strong> - CBT thought pattern specialist</li>
                                <li><strong>Breathwork & Relaxation</strong> techniques</li>
                            </ul>
                        `;
                        break;
                    case 'mood':
                        resultsHTML += `
                            <h4 style="margin-top: 1rem;">For Low Mood:</h4>
                            <ul>
                                <li><strong>Mood Support Sessions</strong></li>
                                <li><strong>AI Coach: Tom</strong> - Identity, purpose, transitions</li>
                                <li><strong>GP Summary Available</strong> - We recommend involving your doctor</li>
                            </ul>
                        `;
                        break;
                    case 'focus':
                        resultsHTML += `
                            <h4 style="margin-top: 1rem;">For Concentration Issues:</h4>
                            <ul>
                                <li><strong>Focus Enhancement Sessions</strong></li>
                                <li><strong>AI Coach: Alastair</strong> - ADHD & concentration specialist</li>
                                <li><strong>Comprehensive Assessment</strong> - Clinical partner available for ADHD screening</li>
                            </ul>
                        `;
                        break;
                    case 'habits':
                        resultsHTML += `
                            <h4 style="margin-top: 1rem;">For Habit Change:</h4>
                            <ul>
                                <li><strong>Targeted Hypnotherapy</strong> - Smoking, drinking, weight management</li>
                                <li><strong>Behavior Change Programs</strong></li>
                                <li><strong>Community Support</strong> for accountability</li>
                            </ul>
                        `;
                        break;
                    case 'community':
                        resultsHTML += `
                            <p style="margin-top: 1rem;">You came looking for community support‚Äîyou're in the right place! Our 91,000 members are here for you.</p>
                        `;
                        break;
                    default: // wellness
                        resultsHTML += `
                            <p style="margin-top: 1rem;">Explore our full range of support options available anytime.</p>
                        `;
                }

                resultsHTML += `<button class="btn btn-secondary" style="margin-top: 1rem;">Explore Your Pathway</button></div>`;

                // OCEAN promotion (if applicable)
                if (profile.oceanCandidate) {
                    resultsHTML += `
                        <div class="ocean-promo">
                            <h3>üéØ Recommended: OCEAN Personality Assessment <span class="ocean-badge">Deep Dive</span></h3>
                            <p>You mentioned wanting to understand yourself better or optimize your wellbeing. The OCEAN assessment is perfect for this.</p>

                            <h4 style="margin-top: 1rem;">What You'll Discover:</h4>
                            <ul>
                                <li><strong>Openness</strong> - Your creativity, curiosity, and approach to new experiences</li>
                                <li><strong>Conscientiousness</strong> - Your organization, responsibility, and goal-orientation</li>
                                <li><strong>Extraversion</strong> - Your social energy and how you recharge</li>
                                <li><strong>Agreeableness</strong> - Your cooperation, empathy, and relationships</li>
                                <li><strong>Neuroticism</strong> - Your emotional stability and stress response patterns</li>
                            </ul>

                            <p style="margin-top: 1rem;"><strong>Takes 20-30 minutes. Provides insights you'll use for years.</strong></p>

                            <p style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">Do it now if you're curious, or save it for this weekend when you have time to reflect.</p>

                            <div style="display: flex; gap: 1rem; margin-top: 1rem; flex-wrap: wrap;">
                                <button class="btn">Start OCEAN Assessment</button>
                                <button class="btn btn-secondary">Tell Me More About OCEAN</button>
                            </div>
                        </div>
                    `;
                } else if (profile.wellness < 3) {
                    // Low prominence OCEAN for struggling users
                    resultsHTML += `
                        <div class="pathway-card">
                            <h3>üìä Coming Soon: OCEAN Personality Deep-Dive</h3>
                            <p>Once you're feeling better, consider our OCEAN personality assessment to understand yourself at a deeper level. It'll be here when you're ready.</p>
                            <button class="btn btn-secondary">Learn More</button>
                        </div>
                    `;
                }

                // GP Summary option (if needed)
                if (profile.needsClinical || profile.wellness < 3) {
                    resultsHTML += `
                        <div class="pathway-card">
                            <h3>üìÑ Optional: Talk to Your GP</h3>
                            <p>If you'd like to involve your doctor, you can download a summary of your check-in to bring to your appointment.</p>
                            <input type="text" id="name-input" placeholder="Your name" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-light); border-radius: 8px; font-size: 0.9rem; margin: 0.75rem 0;">
                            <button class="btn" onclick="app.downloadPDF()">Download GP Summary</button>
                        </div>
                    `;
                }

                pathways.innerHTML = resultsHTML;
            },

            // Download PDF
            downloadPDF() {
                const name = document.getElementById('name-input')?.value;
                if (!name || name.trim() === '') {
                    alert('Please enter your name before downloading the GP summary.');
                    document.getElementById('name-input')?.focus();
                    return;
                }

                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();

                doc.setFont('helvetica');
                doc.setFontSize(10);

                let summary = `PATIENT NAME: ${name}\n`;
                summary += `CHECK-IN DATE: ${new Date().toLocaleDateString('en-GB')}\n\n`;
                summary += '='.repeat(60) + '\n';
                summary += 'CLEAR MINDS WELLNESS CHECK-IN SUMMARY FOR GP\n';
                summary += '='.repeat(60) + '\n\n';

                summary += 'IMPORTANT: This is a wellness check-in, not a clinical assessment.\n\n';

                summary += 'RESPONSES:\n\n';
                this.responses.forEach((response, idx) => {
                    summary += `${idx + 1}. ${response.question.text}\n`;
                    summary += `   Answer: ${response.option.text}\n\n`;
                });

                summary += '\nRECOMMENDATIONS:\n';
                summary += `Primary concern: ${this.userProfile.pathway}\n`;
                summary += `Duration: ${this.userProfile.chronicity}\n`;
                if (this.userProfile.needsClinical) {
                    summary += '\nClinical assessment recommended based on duration and severity.\n';
                }

                summary += '\n\nClear Minds Mental Wellness Platform | clearminds.business';

                const lines = summary.split('\n');
                let y = 15;
                const lineHeight = 5;

                lines.forEach((line) => {
                    if (y > 270) {
                        doc.addPage();
                        y = 15;
                    }
                    const splitLines = doc.splitTextToSize(line, 180);
                    splitLines.forEach((splitLine) => {
                        if (y > 270) {
                            doc.addPage();
                            y = 15;
                        }
                        doc.text(splitLine, 15, y);
                        y += lineHeight;
                    });
                });

                doc.save(`ClearMinds-Check-In-Summary-${name.replace(/\s+/g, '-')}.pdf`);
            },

            // Restart assessment
            restart() {
                this.currentQuestion = 0;
                this.responses = [];
                this.userProfile = {
                    wellness: 0,
                    impact: 0,
                    physicalSymptoms: 0,
                    pathway: '',
                    chronicity: '',
                    socialConnection: 0,
                    readiness: '',
                    workImpact: 0,
                    crisis: false,
                    oceanCandidate: false,
                    needsClinical: false,
                    monitor: false
                };

                document.getElementById('results').classList.add('hidden');
                document.getElementById('pre-assessment').classList.remove('hidden');
            }
        };
    </script>
</body>
</html>
